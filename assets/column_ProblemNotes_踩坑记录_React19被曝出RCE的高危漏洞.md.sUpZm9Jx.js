import{_ as t,C as i,c as n,o as r,j as a,G as l,aQ as o,a as p}from"./chunks/framework.DEi4YP2n.js";const h="/assets/cve.8LOphB-X.png",y=JSON.parse('{"title":"React19 è¢«æ›å‡º RCE é«˜å±æ¼æ´","description":"","frontmatter":{},"headers":[],"relativePath":"column/ProblemNotes/è¸©å‘è®°å½•/React19è¢«æ›å‡ºRCEçš„é«˜å±æ¼æ´.md","filePath":"column/ProblemNotes/è¸©å‘è®°å½•/React19è¢«æ›å‡ºRCEçš„é«˜å±æ¼æ´.md","lastUpdated":1765180204000}'),c={name:"column/ProblemNotes/è¸©å‘è®°å½•/React19è¢«æ›å‡ºRCEçš„é«˜å±æ¼æ´.md"};function d(k,s,g,b,u,m){const e=i("ArticleMetadata");return r(),n("div",null,[s[0]||(s[0]=a("h1",{id:"react19-è¢«æ›å‡º-rce-é«˜å±æ¼æ´",tabindex:"-1"},[p("React19 è¢«æ›å‡º RCE é«˜å±æ¼æ´ "),a("a",{class:"header-anchor",href:"#react19-è¢«æ›å‡º-rce-é«˜å±æ¼æ´","aria-label":'Permalink to "React19 è¢«æ›å‡º RCE é«˜å±æ¼æ´"'},"â€‹")],-1)),l(e),s[1]||(s[1]=o('<div class="warning custom-block"><p class="custom-block-title">æ³¨æ„</p><p><img src="'+h+`" alt="cve" loading="lazy"></p></div><h2 id="ä¸€ã€äº‹ä»¶é€Ÿè§ˆ" tabindex="-1">ä¸€ã€äº‹ä»¶é€Ÿè§ˆ <a class="header-anchor" href="#ä¸€ã€äº‹ä»¶é€Ÿè§ˆ" aria-label="Permalink to &quot;ä¸€ã€äº‹ä»¶é€Ÿè§ˆ&quot;">â€‹</a></h2><p>2025 å¹´ 12 æœˆ 3 æ—¥ï¼ŒReact ä¸ Next.js å®˜æ–¹åŒæ­¥å‘å¸ƒå®‰å…¨å…¬å‘Šï¼š<br><strong>React Server Componentsï¼ˆRSCï¼‰å®ç°ä¸­å­˜åœ¨æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´</strong>ï¼Œç¼–å· <strong>CVE-5-55182</strong>ï¼ˆReact ä¸Šæ¸¸ï¼‰ä¸ <strong>CVE-2025-66478</strong>ï¼ˆNext.js ä¸‹æ¸¸ï¼‰ï¼ŒCVSS è¯„åˆ†ç›´æ¥æ‹‰æ»¡ <strong>10.0 / 10.0</strong>ã€‚</p><ul><li><strong>åˆ©ç”¨æ¡ä»¶</strong>ï¼šä»»æ„å¯è®¿é—®ç›®æ ‡ HTTP ç«¯ç‚¹çš„æ”»å‡»è€…ï¼Œ<strong>æ— éœ€ç™»å½•ã€æ— éœ€äº¤äº’</strong></li><li><strong>å½±å“é¢</strong>ï¼šæ‰€æœ‰å¼€å¯ RSC åŠŸèƒ½ä¸”ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ç«™ç‚¹<strong>é»˜è®¤å³å—æ”»å‡»</strong></li><li><strong>åæœ</strong>ï¼šä»»æ„ä»£ç æ‰§è¡Œã€æ•°æ®æ³„éœ²ã€æœåŠ¡æ¥ç®¡ã€æ¨ªå‘æ¸—é€</li></ul><h2 id="äºŒã€æŠ€æœ¯æ‹†è§£-ä¸€æ¡-http-è¯·æ±‚å¦‚ä½•æ‹¿åˆ°-shell" tabindex="-1">äºŒã€æŠ€æœ¯æ‹†è§£ï¼šä¸€æ¡ HTTP è¯·æ±‚å¦‚ä½•æ‹¿åˆ° Shellï¼Ÿ <a class="header-anchor" href="#äºŒã€æŠ€æœ¯æ‹†è§£-ä¸€æ¡-http-è¯·æ±‚å¦‚ä½•æ‹¿åˆ°-shell" aria-label="Permalink to &quot;äºŒã€æŠ€æœ¯æ‹†è§£ï¼šä¸€æ¡ HTTP è¯·æ±‚å¦‚ä½•æ‹¿åˆ° Shellï¼Ÿ&quot;">â€‹</a></h2><h3 id="_1-æ ¹æœ¬åŸå› -â€”â€”-flight-ååºåˆ—åŒ–ç¼ºå¤±æ ¡éªŒ" tabindex="-1">1. æ ¹æœ¬åŸå›  â€”â€” Flight ååºåˆ—åŒ–ç¼ºå¤±æ ¡éªŒ <a class="header-anchor" href="#_1-æ ¹æœ¬åŸå› -â€”â€”-flight-ååºåˆ—åŒ–ç¼ºå¤±æ ¡éªŒ" aria-label="Permalink to &quot;1. æ ¹æœ¬åŸå›  â€”â€” Flight ååºåˆ—åŒ–ç¼ºå¤±æ ¡éªŒ&quot;">â€‹</a></h3><p>RSC é‡‡ç”¨è‡ªå®šä¹‰ã€ŒFlightã€åè®®åœ¨å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ä¹‹é—´åºåˆ—åŒ–ç»„ä»¶æ ‘ä¸ Server Actionã€‚<br> æœåŠ¡ç«¯åœ¨é‡æ„è°ƒç”¨é“¾æ—¶ï¼Œ<strong>æœªå¯¹ <code>moduleId#exportName</code> åš <code>hasOwnProperty</code> æ ¡éªŒ</strong>ï¼Œå¯¼è‡´æ”»å‡»è€…å¯é€šè¿‡åŸå‹é“¾æ±¡æŸ“è®¿é—®åˆ° Node.js å†…ç½®æ¨¡å—ï¼ˆ<code>child_process</code>ã€<code>vm</code> ç­‰ï¼‰ã€‚</p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ç®€åŒ–æ¼æ´ä»£ç </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> resolveServerReference</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">modId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">expName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> mod</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> requireModule</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(modId);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // âŒ ç¼ºå¤± hasOwnProperty æ£€æŸ¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mod[expName]; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å¯å‘½ä¸­ Object.prototype.constructor</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="_2-æ”»å‡»æµç¨‹-poc-å·²å…¬å¼€" tabindex="-1">2. æ”»å‡»æµç¨‹ï¼ˆPoC å·²å…¬å¼€ï¼‰ <a class="header-anchor" href="#_2-æ”»å‡»æµç¨‹-poc-å·²å…¬å¼€" aria-label="Permalink to &quot;2. æ”»å‡»æµç¨‹ï¼ˆPoC å·²å…¬å¼€ï¼‰&quot;">â€‹</a></h3><ol><li>æ„é€ æ¶æ„ RSC è½½è·ï¼Œå°† <code>$ACTION_REF_123</code> è¡¨å•é¡¹æŒ‡å‘ <code>child_process#execSync</code></li><li>å‘é€ POST <code>/formaction</code>ï¼ˆæˆ–å…¶ä»– Server Action ç«¯ç‚¹ï¼‰</li><li>æœåŠ¡ç«¯è§£ææ—¶æ²¿ç€åŸå‹é“¾æ‹¿åˆ° <code>execSync</code>ï¼Œæ‹¼æ¥æ”»å‡»è€…å‘½ä»¤å¹¶æ‰§è¡Œ</li><li>è¿”å›ç»“æœä¸­å¯ç›´æ¥å¸¦å‡ºæ§åˆ¶å°è¾“å‡ºï¼Œå®Œæˆ <strong>RCE â†’ åå¼¹ Shell / å†™åé—¨</strong></li></ol><blockquote><p>å·²æœ‰å¼€æºæ‰«æå™¨æ‰¹é‡æ¢æµ‹äº’è”ç½‘èµ„äº§ï¼Œ<strong>æš´éœ²åœ¨å¤–ç½‘çš„ Next.js App Router ç«™ç‚¹è¢«å¤§è§„æ¨¡æ¤å…¥æŒ–çŸ¿ã€åé—¨</strong>ã€‚</p></blockquote><h2 id="ä¸‰ã€å—å½±å“ç‰ˆæœ¬ä¸ç”Ÿæ€" tabindex="-1">ä¸‰ã€å—å½±å“ç‰ˆæœ¬ä¸ç”Ÿæ€ <a class="header-anchor" href="#ä¸‰ã€å—å½±å“ç‰ˆæœ¬ä¸ç”Ÿæ€" aria-label="Permalink to &quot;ä¸‰ã€å—å½±å“ç‰ˆæœ¬ä¸ç”Ÿæ€&quot;">â€‹</a></h2><table tabindex="0"><thead><tr><th>ç»„ä»¶ / æ¡†æ¶</th><th>å—å½±å“ç‰ˆæœ¬</th><th>å®‰å…¨ç‰ˆæœ¬</th></tr></thead><tbody><tr><td>react-server-dom-webpack</td><td>19.0.0 â€‘ 19.2.0</td><td>â‰¥ 19.0.1 / 19.1.2 / 19.2.1</td></tr><tr><td>react-server-dom-parcel</td><td>åŒä¸Š</td><td>åŒä¸Š</td></tr><tr><td>react-server-dom-turbopack</td><td>åŒä¸Š</td><td>åŒä¸Š</td></tr><tr><td>Next.js App Router</td><td>14.3.0-canary.77 ~ 15.0.4<br>15.1.0 ~ 15.1.8<br>15.2.0 ~ 15.2.5 â€¦ï¼ˆè¯¦è§å®˜æ–¹å…¬å‘Šï¼‰</td><td>â‰¥ 15.0.5 / 15.1.9 / 15.2.6 â€¦</td></tr><tr><td>è¡ç”Ÿæ¡†æ¶</td><td>LobeChatã€Difyã€Wakuã€Redwoodã€@vitejs/plugin-rsc â€¦</td><td>è¯·ç­‰å¾…ä¸Šæ¸¸æ›´æ–°</td></tr></tbody></table><blockquote><p>ä»…ä½¿ç”¨ <strong>Pages Router</strong> æˆ– <strong>çº¯å®¢æˆ·ç«¯æ¸²æŸ“</strong> çš„åº”ç”¨<strong>ä¸åœ¨å½±å“èŒƒå›´</strong>ã€‚</p></blockquote><h2 id="å››ã€ä¿®å¤ä¸ç¼“è§£" tabindex="-1">å››ã€ä¿®å¤ä¸ç¼“è§£ <a class="header-anchor" href="#å››ã€ä¿®å¤ä¸ç¼“è§£" aria-label="Permalink to &quot;å››ã€ä¿®å¤ä¸ç¼“è§£&quot;">â€‹</a></h2><h3 id="å®˜æ–¹ä¿®å¤" tabindex="-1">å®˜æ–¹ä¿®å¤ <a class="header-anchor" href="#å®˜æ–¹ä¿®å¤" aria-label="Permalink to &quot;å®˜æ–¹ä¿®å¤&quot;">â€‹</a></h3><p><code>react</code> å®˜ç½‘è§£å†³æ–¹æ¡ˆï¼š<a href="https://react.dev/blog/2025/12/03/critical-security-vulnerability-in-react-server-components" target="_blank" rel="noreferrer">https://react.dev/blog/2025/12/03/critical-security-vulnerability-in-react-server-components</a></p><ol><li><strong>ç«‹å³å‡çº§</strong>è‡³å®‰å…¨ç‰ˆæœ¬<div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># npm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> react-server-dom-webpack@19.2.1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> next@15.2.6</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># pnpm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> react-server-dom-webpack@19.2.1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> next@15.2.6</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li><li>é‡æ–°æ„å»ºå¹¶èµ°å®Œæ•´ CI/CDï¼Œ<strong>ç¡®è®¤ lock æ–‡ä»¶</strong>å·²åˆ·æ–°ã€‚</li></ol><h3 id="ğŸ†˜-ä¸´æ—¶ç¼“è§£-æ— æ³•ç«‹å³å‡çº§æ—¶" tabindex="-1">ğŸ†˜ ä¸´æ—¶ç¼“è§£ï¼ˆæ— æ³•ç«‹å³å‡çº§æ—¶ï¼‰ <a class="header-anchor" href="#ğŸ†˜-ä¸´æ—¶ç¼“è§£-æ— æ³•ç«‹å³å‡çº§æ—¶" aria-label="Permalink to &quot;ğŸ†˜ ä¸´æ—¶ç¼“è§£ï¼ˆæ— æ³•ç«‹å³å‡çº§æ—¶ï¼‰&quot;">â€‹</a></h3><ul><li><strong>WAF / API ç½‘å…³</strong>è§„åˆ™ï¼šæ‹¦æˆªè¯·æ±‚ä½“åŒ…å« <code>$ACTION_REF</code>ã€<code>__proto__</code>ã€<code>constructor</code> ç­‰å…³é”®å­—</li><li><strong>åå‘ä»£ç†å±‚</strong>å…³é—­å¯¹ <code>/_next/*</code> æˆ– <code>/formaction</code> çš„å…¬ç½‘è®¿é—®</li><li><strong>å®¹å™¨æ²™ç®±</strong>ï¼šç»™ Node è¿›ç¨‹åŠ  <code>seccomp</code> / <code>AppArmor</code>ï¼Œç¦æ­¢ <code>exec</code> æ—ç³»ç»Ÿè°ƒç”¨</li><li><strong>è¿è¡Œæ—¶é’©å­</strong>ï¼šåœ¨ <code>require()</code> å±‚é¢å¯¹ <code>child_process</code>ã€<code>vm</code> ç­‰æ¨¡å—åšç™½åå•æ‹¦æˆª</li></ul><h2 id="äº”ã€è‡ªæŸ¥è„šæœ¬" tabindex="-1">äº”ã€è‡ªæŸ¥è„šæœ¬ <a class="header-anchor" href="#äº”ã€è‡ªæŸ¥è„šæœ¬" aria-label="Permalink to &quot;äº”ã€è‡ªæŸ¥è„šæœ¬&quot;">â€‹</a></h2><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1. æ£€æŸ¥æ˜¯å¦å¼•ç”¨å—å½±å“åŒ…</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ls</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> react-server-dom-webpack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> react-server-dom-parcel</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> react-server-dom-turbopack</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 2. æ£€æŸ¥ Next.js ç‰ˆæœ¬</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> list</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> next</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 3. ç¡®è®¤æ˜¯å¦å­˜åœ¨ Server Action ç«¯ç‚¹ï¼ˆæœç´¢æ–‡ä»¶ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;use server&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>è‹¥ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´ä¸”å­˜åœ¨ Server Actionï¼Œ<strong>å³ä¸ºé«˜å±</strong>ï¼Œè¯·ç«‹å³æ‰§è¡Œå‡çº§ã€‚</p><h2 id="å‚è€ƒä¸å»¶ä¼¸é˜…è¯»" tabindex="-1">å‚è€ƒä¸å»¶ä¼¸é˜…è¯» <a class="header-anchor" href="#å‚è€ƒä¸å»¶ä¼¸é˜…è¯»" aria-label="Permalink to &quot;å‚è€ƒä¸å»¶ä¼¸é˜…è¯»&quot;">â€‹</a></h2><p>çŸ¥ä¹: <a href="https://zhuanlan.zhihu.com/p/1980296882984067851" target="_blank" rel="noreferrer">https://zhuanlan.zhihu.com/p/1980296882984067851</a><br> é˜¿é‡Œäº‘: <a href="https://www.aliyun.com/notice/117771" target="_blank" rel="noreferrer">https://www.aliyun.com/notice/117771</a><br> segmentfault çŸ¥å¦: <a href="https://segmentfault.com/a/1190000047451749" target="_blank" rel="noreferrer">https://segmentfault.com/a/1190000047451749</a><br> CSDN åšå®¢: <a href="https://blog.csdn.net/lightningyang/article/details/155613936" target="_blank" rel="noreferrer">https://blog.csdn.net/lightningyang/article/details/155613936</a><br> åšå®¢å›­: <a href="https://www.cnblogs.com/yupi/p/19320774" target="_blank" rel="noreferrer">https://www.cnblogs.com/yupi/p/19320774</a><br> CN-SEC ä¸­æ–‡ç½‘: <a href="https://cn-sec.com/archives/4757079.html" target="_blank" rel="noreferrer">https://cn-sec.com/archives/4757079.html</a></p>`,25))])}const C=t(c,[["render",d]]);export{y as __pageData,C as default};
