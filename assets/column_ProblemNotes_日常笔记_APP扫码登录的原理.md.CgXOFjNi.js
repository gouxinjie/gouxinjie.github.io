import{_ as E,C as e,c as A,o,j as n,G as i,aQ as l,b as c,a as t,w as r,aS as p}from"./chunks/framework.DEi4YP2n.js";const f=JSON.parse('{"title":"一扫即登：扫码登录的原理","description":"","frontmatter":{},"headers":[],"relativePath":"column/ProblemNotes/日常笔记/APP扫码登录的原理.md","filePath":"column/ProblemNotes/日常笔记/APP扫码登录的原理.md","lastUpdated":1764148425000}'),g={name:"column/ProblemNotes/日常笔记/APP扫码登录的原理.md"};function h(u,a,B,b,_,m){const s=e("ArticleMetadata"),d=e("Mermaid");return o(),A("div",null,[a[1]||(a[1]=n("h1",{id:"一扫即登-扫码登录的原理",tabindex:"-1"},[t("一扫即登：扫码登录的原理 "),n("a",{class:"header-anchor",href:"#一扫即登-扫码登录的原理","aria-label":'Permalink to "一扫即登：扫码登录的原理"'},"​")],-1)),i(s),a[2]||(a[2]=l('<nav class="table-of-contents"><ul><li><a href="#核心思想-授权-而非传输密码">核心思想：授权，而非传输密码</a></li><li><a href="#五步拆解-从二维码到登录成功">五步拆解：从二维码到登录成功</a><ul><li><a href="#第-1-步-电脑生成二维码">第 1 步：电脑生成二维码</a></li><li><a href="#第-2-步-手机扫描二维码">第 2 步：手机扫描二维码</a></li><li><a href="#第-3-步-手机确认登录-关键授权步骤">第 3 步：手机确认登录（关键授权步骤）</a></li><li><a href="#第-4-步-服务器完成授权绑定">第 4 步：服务器完成授权绑定</a></li><li><a href="#第-5-步-电脑轮询成功-完成登录">第 5 步：电脑轮询成功，完成登录</a></li></ul></li><li><a href="#为什么它既方便又安全">为什么它既方便又安全？</a></li><li><a href="#扫码登录的状态管理">扫码登录的状态管理</a><ul><li><a href="#核心的五个状态">核心的五个状态</a></li></ul></li></ul></nav><h2 id="核心思想-授权-而非传输密码" tabindex="-1">核心思想：授权，而非传输密码 <a class="header-anchor" href="#核心思想-授权-而非传输密码" aria-label="Permalink to &quot;核心思想：授权，而非传输密码&quot;">​</a></h2><p>首先要明确一个核心概念：扫码登录的本质是 <strong>“授权”</strong> ，而不是“传输密码”。</p><p>在整个流程中，你的密码<strong>从未</strong>被传输或填写。它依赖的是一个你已经登录并信任的设备（通常是手机），去授权另一个新设备（通常是电脑）进行登录。这就像你用一把物理钥匙（手机），去授权复制一把新的临时钥匙（电脑会话）。</p><p>为了直观地把握全局，下图清晰地展示了扫码登录全过程中，用户、手机 App 与服务端三者之间的交互流程：</p>',5)),(o(),c(p,null,{default:r(()=>[i(d,{id:"mermaid-18",class:"mermaid",graph:"flowchart%20TD%0A%20%20%20%20subgraph%20A%20%5B%E7%94%A8%E6%88%B7%E7%94%B5%E8%84%91%5D%0A%20%20%20%20%20%20%20%20direction%20TB%0A%20%20%20%20%20%20%20%20PC%5B%E6%B5%8F%E8%A7%88%E5%99%A8%5D%0A%20%20%20%20%20%20%20%20A_Display%5B%E6%98%BE%E7%A4%BA%E4%BA%8C%E7%BB%B4%E7%A0%81%3Cbr%3E%E5%8F%8A%E8%BD%AE%E8%AF%A2%E7%8A%B6%E6%80%81%5D%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20B%20%5B%E6%89%8B%E6%9C%BAApp%5D%0A%20%20%20%20%20%20%20%20direction%20TB%0A%20%20%20%20%20%20%20%20App%5BApp%5D%0A%20%20%20%20%20%20%20%20B_Scan%5B%E6%89%AB%E6%8F%8F%E4%BA%8C%E7%BB%B4%E7%A0%81%5D%0A%20%20%20%20%20%20%20%20B_Confirm%5B%E7%82%B9%E5%87%BB%E7%A1%AE%E8%AE%A4%E7%99%BB%E5%BD%95%5D%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20C%20%5B%E6%9C%8D%E5%8A%A1%E7%AB%AF%5D%0A%20%20%20%20%20%20%20%20direction%20TB%0A%20%20%20%20%20%20%20%20AuthServer%5B%E8%AE%A4%E8%AF%81%E6%9C%8D%E5%8A%A1%E5%99%A8%5D%0A%20%20%20%20%20%20%20%20C_QR%5B%E7%94%9F%E6%88%90%E4%BB%A4%E7%89%8C%E4%B8%8E%E4%BA%8C%E7%BB%B4%E7%A0%81%5D%0A%20%20%20%20%20%20%20%20C_Wait%5B%E7%AD%89%E5%BE%85%E6%89%AB%E6%8F%8F%5D%0A%20%20%20%20%20%20%20%20C_Confirm%5B%E7%AD%89%E5%BE%85%E7%A1%AE%E8%AE%A4%5D%0A%20%20%20%20%20%20%20%20C_Login%5B%E6%8E%88%E6%9D%83%E7%99%BB%E5%BD%95%5D%0A%20%20%20%20end%0A%0A%20%20%20%20C_QR%20--%20%E4%BA%8C%E7%BB%B4%E7%A0%81%E5%8C%85%E5%90%ABToken%20%26%20%E5%9B%BE%E7%89%87%20--%3E%20A_Display%0A%20%20%20%20A_Display%20--%20%E7%94%A8%E6%88%B7%E6%89%93%E5%BC%80%E6%89%AB%E7%A0%81%E7%95%8C%E9%9D%A2%20--%3E%20B_Scan%0A%20%20%20%20B_Scan%20--%20%E8%A7%A3%E6%9E%90%E5%87%BAToken%20--%3E%20App%0A%20%20%20%20App%20--%20%E6%90%BA%E5%B8%A6%E7%94%A8%E6%88%B7%E5%87%AD%E8%AF%81%3Cbr%3E%E6%8F%90%E4%BA%A4Token%20--%3E%20C_Wait%0A%20%20%20%20C_Wait%20--%20%E6%89%AB%E6%8F%8F%E7%8A%B6%E6%80%81%E6%9B%B4%E6%96%B0%20--%3E%20C_Confirm%0A%20%20%20%20B_Confirm%20--%20%E7%94%A8%E6%88%B7%E7%82%B9%E5%87%BB%E7%A1%AE%E8%AE%A4%20--%3E%20C_Confirm%0A%20%20%20%20C_Confirm%20--%20%E7%A1%AE%E8%AE%A4%E7%8A%B6%E6%80%81%E6%9B%B4%E6%96%B0%20--%3E%20C_Login%0A%20%20%20%20PC%20--%20%E5%AE%9A%E6%97%B6%E8%BD%AE%E8%AF%A2%3Cbr%3E%E2%80%9C%E7%99%BB%E5%BD%95%E6%88%90%E5%8A%9F%E4%BA%86%E5%90%97%EF%BC%9F%E2%80%9D%20--%3E%20C_Login%0A%20%20%20%20C_Login%20--%20%E8%BF%94%E5%9B%9E%E6%8E%88%E6%9D%83%E4%BB%A4%E7%89%8C%20--%3E%20PC%0A"})]),fallback:r(()=>[...a[0]||(a[0]=[t(" Loading... ",-1)])]),_:1})),a[3]||(a[3]=l(`<h2 id="五步拆解-从二维码到登录成功" tabindex="-1">五步拆解：从二维码到登录成功 <a class="header-anchor" href="#五步拆解-从二维码到登录成功" aria-label="Permalink to &quot;五步拆解：从二维码到登录成功&quot;">​</a></h2><p>让我们结合上面的流程图，一步步拆解这个过程：</p><h3 id="第-1-步-电脑生成二维码" tabindex="-1">第 1 步：电脑生成二维码 <a class="header-anchor" href="#第-1-步-电脑生成二维码" aria-label="Permalink to &quot;第 1 步：电脑生成二维码&quot;">​</a></h3><p>当你在电脑上点击“扫码登录”时：</p><ol><li>你的<strong>浏览器</strong>会向网站的<strong>认证服务器</strong>发起一个请求：“我准备扫码登录了”。</li><li>服务器会生成一个<strong>唯一的、临时的、有时效的身份标识</strong>，我们称之为 <code>Token</code>（令牌）。例如，它可能是一个像 <code>xyz123abc</code> 这样的随机字符串。</li><li>服务器将这个 <code>Token</code> 与当前的浏览器会话绑定，并将其编码成一个 URL（例如 <code>https://example.com/auth?token=xyz123abc</code>），再生成二维码图片。</li><li>图片显示在屏幕上，同时，浏览器开始<strong>不断地向服务器轮询</strong>：“请问 <code>Token: xyz123abc</code> 的状态变了吗？用户扫码了吗？”</li></ol><h3 id="第-2-步-手机扫描二维码" tabindex="-1">第 2 步：手机扫描二维码 <a class="header-anchor" href="#第-2-步-手机扫描二维码" aria-label="Permalink to &quot;第 2 步：手机扫描二维码&quot;">​</a></h3><ol><li>你拿出已经登录了对应 App（如微信、淘宝）的<strong>手机</strong>，打开扫一扫功能。</li><li>手机摄像头扫描二维码，App<strong>解析出里面的 URL 和 <code>Token</code></strong>。</li></ol><p>例如：</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>https://example.com/scan?login_key=88a9-x9</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="第-3-步-手机确认登录-关键授权步骤" tabindex="-1">第 3 步：手机确认登录（关键授权步骤） <a class="header-anchor" href="#第-3-步-手机确认登录-关键授权步骤" aria-label="Permalink to &quot;第 3 步：手机确认登录（关键授权步骤）&quot;">​</a></h3><ol><li>手机 App 会<strong>携带解析出的 <code>Token</code> 和它本身已存储的登录凭证</strong>（代表你已在此手机登录），一起发送给服务器。</li><li>通常，手机会弹出一个确认界面，显示“请在电脑上登录 XXX”，你点击**“确认”**。这一步至关重要，它确保了登录行为是你的主动意愿，防止误操作。</li></ol><h3 id="第-4-步-服务器完成授权绑定" tabindex="-1">第 4 步：服务器完成授权绑定 <a class="header-anchor" href="#第-4-步-服务器完成授权绑定" aria-label="Permalink to &quot;第 4 步：服务器完成授权绑定&quot;">​</a></h3><p>服务器收到手机的请求后，会进行三重验证：</p><ol><li><strong>验手机</strong>：通过手机传来的凭证，确认你是合法用户（比如用户张三）。</li><li><strong>验 Token</strong>：确认 <code>Token (xyz123abc)</code> 是有效且未过期的。</li><li><strong>绑关系</strong>：将 <code>Token (xyz123abc)</code> 和你的身份（用户张三）<strong>绑定在一起</strong>，并将该 <code>Token</code> 的状态标记为“已授权”。</li></ol><h3 id="第-5-步-电脑轮询成功-完成登录" tabindex="-1">第 5 步：电脑轮询成功，完成登录 <a class="header-anchor" href="#第-5-步-电脑轮询成功-完成登录" aria-label="Permalink to &quot;第 5 步：电脑轮询成功，完成登录&quot;">​</a></h3><ol><li>此时，电脑浏览器又一次轮询服务器：“<code>Token (xyz123abc)</code> 的状态变了吗？”</li><li>服务器这次返回成功信息：“登录成功！”，并附上电脑端登录所需的凭证（如设置 Cookie）。</li><li>浏览器收到响应，知道你已授权，于是将页面跳转或刷新，你便看到自己已经登录了。</li></ol><h2 id="为什么它既方便又安全" tabindex="-1">为什么它既方便又安全？ <a class="header-anchor" href="#为什么它既方便又安全" aria-label="Permalink to &quot;为什么它既方便又安全？&quot;">​</a></h2><ol><li><strong>密码零输入，防窃听</strong>：整个过程密码不参与，从根本上避免了密码在输入时被键盘记录器或钓鱼网站窃取的风险。</li><li><strong>双重认证（2FA）</strong>：这本质上是一种双因子认证。你拥有的东西（已登录的手机）和你的操作（点击确认）共同完成了登录，安全性远高于单一密码。</li><li><strong>临时令牌</strong>：二维码背后的 <code>Token</code> 是临时的（通常 1-2 分钟有效），且一次性使用。即使被恶意截获，也很快会失效。</li><li><strong>用户知情与控制</strong>：关键的“确认”步骤让你拥有最终决定权，防止被恶意二维码“偷袭”登录。</li></ol><h2 id="扫码登录的状态管理" tabindex="-1">扫码登录的状态管理 <a class="header-anchor" href="#扫码登录的状态管理" aria-label="Permalink to &quot;扫码登录的状态管理&quot;">​</a></h2><p>让我们来详细拆解一下这个过程到底有哪几个状态：</p><h3 id="核心的五个状态" tabindex="-1">核心的五个状态 <a class="header-anchor" href="#核心的五个状态" aria-label="Permalink to &quot;核心的五个状态&quot;">​</a></h3><p>通常，一个完整的扫码登录流程包含以下五个关键状态：</p><h4 id="_1-待扫描-pending-generated" tabindex="-1">1. <strong>待扫描（Pending / Generated）</strong> <a class="header-anchor" href="#_1-待扫描-pending-generated" aria-label="Permalink to &quot;1. **待扫描（Pending / Generated）**&quot;">​</a></h4><ul><li><strong>含义</strong>：二维码刚生成，正在等待被手机扫描。</li><li><strong>表现</strong>：电脑屏幕显示二维码，提示&quot;请使用手机 App 扫码&quot;。</li><li><strong>后台逻辑</strong>：服务器已生成 Token，但尚未收到任何扫描请求。</li></ul><h4 id="_2-已扫描-scanned-detected" tabindex="-1">2. <strong>已扫描（Scanned / Detected）</strong> <a class="header-anchor" href="#_2-已扫描-scanned-detected" aria-label="Permalink to &quot;2. **已扫描（Scanned / Detected）**&quot;">​</a></h4><ul><li><strong>含义</strong>：手机已经成功扫描二维码，但用户尚未点击确认。</li><li><strong>表现</strong>：电脑界面变为&quot;扫描成功，请在手机端确认&quot;；手机弹出确认对话框。</li><li><strong>触发条件</strong>：手机 App 解析 Token 并发送到服务器验证其有效性。</li><li><strong>安全意义</strong>：防止恶意二维码被扫描后直接登录，给用户反悔的机会。</li></ul><h4 id="_3-已确认-confirmed-authorized" tabindex="-1">3. <strong>已确认（Confirmed / Authorized）</strong> <a class="header-anchor" href="#_3-已确认-confirmed-authorized" aria-label="Permalink to &quot;3. **已确认（Confirmed / Authorized）**&quot;">​</a></h4><ul><li><strong>含义</strong>：用户在手机端点击了&quot;确认登录&quot;按钮。</li><li><strong>表现</strong>：手机显示&quot;登录成功&quot;；电脑界面仍在等待或开始跳转。</li><li><strong>触发条件</strong>：用户主动点击确认，手机将授权信息发送到服务器。</li><li><strong>关键作用</strong>：这是真正的授权动作，服务器将 Token 与用户身份绑定。</li></ul><h4 id="_4-已登录-logged-in-success" tabindex="-1">4. <strong>已登录（Logged In / Success）</strong> <a class="header-anchor" href="#_4-已登录-logged-in-success" aria-label="Permalink to &quot;4. **已登录（Logged In / Success）**&quot;">​</a></h4><ul><li><strong>含义</strong>：电脑端已完成登录，获得了用户会话。</li><li><strong>表现</strong>：电脑界面跳转到登录后的首页，显示用户信息。</li><li><strong>触发条件</strong>：电脑轮询到&quot;已确认&quot;状态，服务器返回登录凭证。</li></ul><h4 id="_5-已过期-失效-expired-invalid" tabindex="-1">5. <strong>已过期/失效（Expired / Invalid）</strong> <a class="header-anchor" href="#_5-已过期-失效-expired-invalid" aria-label="Permalink to &quot;5. **已过期/失效（Expired / Invalid）**&quot;">​</a></h4><ul><li><strong>含义</strong>：二维码超过有效期或因其他原因失效。</li><li><strong>表现</strong>：电脑显示&quot;二维码已过期，请刷新重试&quot;。</li><li><strong>触发条件</strong>： <ul><li>时间过期（通常 1-2 分钟）</li><li>被新二维码替换</li><li>用户多次扫描同一二维码</li><li>安全风险被系统主动终止</li></ul></li></ul><p>这五个状态形成一个严格的单向流转：</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>待扫描 → 已扫描 → 已确认 → 已登录</span></span>
<span class="line"><span>  ↓        ↓        ↓        ↓</span></span>
<span class="line"><span>过期     过期     过期     (正常结束)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div>`,34))])}const k=E(g,[["render",h]]);export{f as __pageData,k as default};
