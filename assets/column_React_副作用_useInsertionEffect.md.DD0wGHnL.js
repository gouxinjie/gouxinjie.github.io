import{_ as n,C as t,c as e,o as l,j as a,G as p,aQ as h,a as r}from"./chunks/framework.DEi4YP2n.js";const b=JSON.parse('{"title":"useInsertionEffectï¼šæ ·å¼æ³¨å…¥ Hook","description":"","frontmatter":{},"headers":[],"relativePath":"column/React/å‰¯ä½œç”¨/useInsertionEffect.md","filePath":"column/React/å‰¯ä½œç”¨/useInsertionEffect.md","lastUpdated":1759999524000}'),k={name:"column/React/å‰¯ä½œç”¨/useInsertionEffect.md"};function d(E,s,c,o,u,g){const i=t("ArticleMetadata");return l(),e("div",null,[s[0]||(s[0]=a("h1",{id:"useinsertioneffect-æ ·å¼æ³¨å…¥-hook",tabindex:"-1"},[r("useInsertionEffectï¼šæ ·å¼æ³¨å…¥ Hook "),a("a",{class:"header-anchor",href:"#useinsertioneffect-æ ·å¼æ³¨å…¥-hook","aria-label":'Permalink to "useInsertionEffectï¼šæ ·å¼æ³¨å…¥ Hook"'},"â€‹")],-1)),p(i),s[1]||(s[1]=h(`<nav class="table-of-contents"><ul><li><a href="#ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦-useinsertioneffect">ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦ useInsertionEffectï¼Ÿ</a></li><li><a href="#äºŒã€useinsertioneffect-æ˜¯ä»€ä¹ˆ">äºŒã€useInsertionEffect æ˜¯ä»€ä¹ˆï¼Ÿ</a><ul><li><a href="#ğŸ“˜-åŸºæœ¬è¯­æ³•">ğŸ“˜ åŸºæœ¬è¯­æ³•ï¼š</a></li></ul></li><li><a href="#ä¸‰ã€æ‰§è¡Œæ—¶æœºå¯¹æ¯”å›¾">ä¸‰ã€æ‰§è¡Œæ—¶æœºå¯¹æ¯”å›¾</a></li><li><a href="#å››ã€å®é™…ä¾‹å­-æ¨¡æ‹Ÿ-css-in-js-æ³¨å…¥">å››ã€å®é™…ä¾‹å­ï¼šæ¨¡æ‹Ÿ CSS-in-JS æ³¨å…¥</a></li><li><a href="#äº”ã€ä¸-uselayouteffect-çš„åŒºåˆ«">äº”ã€ä¸ useLayoutEffect çš„åŒºåˆ«</a></li><li><a href="#å…­ã€ä¸ºä»€ä¹ˆ-react-è¦å•ç‹¬ä¸ºæ ·å¼è®¾è®¡ä¸€ä¸ª-hook">å…­ã€ä¸ºä»€ä¹ˆ React è¦å•ç‹¬ä¸ºæ ·å¼è®¾è®¡ä¸€ä¸ª Hookï¼Ÿ</a></li><li><a href="#ä¸ƒã€åœ¨æ¡†æ¶ä¸­çš„å®é™…åº”ç”¨">ä¸ƒã€åœ¨æ¡†æ¶ä¸­çš„å®é™…åº”ç”¨</a></li></ul></nav><blockquote><p>React 18 é™¤äº†å¸¦æ¥ <code>useTransition</code>ã€<code>useDeferredValue</code> ç­‰å¸¸ç”¨çš„å¹¶å‘ç‰¹æ€§å¤–ï¼Œ<br> è¿˜æ–°å¢äº†ä¸€ä¸ªä¸“ä¸º <strong>æ ·å¼æ³¨å…¥ï¼ˆStyle Insertionï¼‰</strong> è®¾è®¡çš„ Hook â€”â€” <code>useInsertionEffect</code>ã€‚</p><p>å®ƒçš„ä¸»è¦ä½œç”¨æ˜¯ï¼š<strong>åœ¨ DOM å˜æ›´å‰æ‰§è¡Œå‰¯ä½œç”¨ï¼Œä¿è¯æ ·å¼ä¼˜å…ˆæ’å…¥</strong>ã€‚</p></blockquote><h2 id="ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦-useinsertioneffect" tabindex="-1">ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦ useInsertionEffectï¼Ÿ <a class="header-anchor" href="#ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦-useinsertioneffect" aria-label="Permalink to &quot;ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦ useInsertionEffectï¼Ÿ&quot;">â€‹</a></h2><p>åœ¨ React 18 ä¹‹å‰ï¼ŒCSS-in-JS åº“ï¼ˆå¦‚ <code>emotion</code>ã€<code>styled-components</code>ï¼‰ é€šå¸¸åœ¨ <code>useLayoutEffect</code> æˆ– <code>useEffect</code> ä¸­æ’å…¥æ ·å¼ã€‚</p><p>ç„¶è€Œï¼Œè¿™ä¼šå‡ºç°ä¸¤ä¸ªé—®é¢˜ï¼š</p><ol><li><strong>æ ·å¼é—ªçƒï¼ˆFOUCï¼‰</strong>ï¼šç»„ä»¶æ¸²æŸ“äº†ï¼Œä½†æ ·å¼è¿˜æ²¡æ’å…¥ã€‚</li><li><strong>æ’å…¥é¡ºåºé”™è¯¯</strong>ï¼šå¤šä¸ªæ ·å¼æ›´æ–°æ—¶ï¼Œåæ¸²æŸ“çš„ç»„ä»¶æ ·å¼å¯èƒ½è¦†ç›–å‰é¢çš„ã€‚</li></ol><p>React 18 ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸“é—¨å¼•å…¥äº† <code>useInsertionEffect</code> â€”â€” å®ƒçš„æ‰§è¡Œæ—¶æœºæ¯” <code>useLayoutEffect</code> è¿˜è¦æ—©ï¼</p><h2 id="äºŒã€useinsertioneffect-æ˜¯ä»€ä¹ˆ" tabindex="-1">äºŒã€useInsertionEffect æ˜¯ä»€ä¹ˆï¼Ÿ <a class="header-anchor" href="#äºŒã€useinsertioneffect-æ˜¯ä»€ä¹ˆ" aria-label="Permalink to &quot;äºŒã€useInsertionEffect æ˜¯ä»€ä¹ˆï¼Ÿ&quot;">â€‹</a></h2><h3 id="ğŸ“˜-åŸºæœ¬è¯­æ³•" tabindex="-1">ğŸ“˜ åŸºæœ¬è¯­æ³•ï¼š <a class="header-anchor" href="#ğŸ“˜-åŸºæœ¬è¯­æ³•" aria-label="Permalink to &quot;ğŸ“˜ åŸºæœ¬è¯­æ³•ï¼š&quot;">â€‹</a></h3><div class="language-tsx vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">tsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">useInsertionEffect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(setup, dependencies</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>è¯´æ˜</th><th></th></tr></thead><tbody><tr><td><code>setup</code></td><td>\`() =&gt; void</td><td>(() =&gt; void)\`</td><td>ç”¨äºæ’å…¥æ ·å¼çš„å‡½æ•°</td></tr><tr><td><code>dependencies</code></td><td><code>any[]</code></td><td>ä¾èµ–æ•°ç»„ï¼Œå†³å®šä½•æ—¶é‡æ–°æ‰§è¡Œ</td><td></td></tr></tbody></table><h2 id="ä¸‰ã€æ‰§è¡Œæ—¶æœºå¯¹æ¯”å›¾" tabindex="-1">ä¸‰ã€æ‰§è¡Œæ—¶æœºå¯¹æ¯”å›¾ <a class="header-anchor" href="#ä¸‰ã€æ‰§è¡Œæ—¶æœºå¯¹æ¯”å›¾" aria-label="Permalink to &quot;ä¸‰ã€æ‰§è¡Œæ—¶æœºå¯¹æ¯”å›¾&quot;">â€‹</a></h2><table tabindex="0"><thead><tr><th>Hook</th><th>æ‰§è¡Œæ—¶æœº</th><th>ç”¨é€”</th></tr></thead><tbody><tr><td><code>useEffect</code></td><td>åœ¨æµè§ˆå™¨å®Œæˆç»˜åˆ¶å</td><td>å¼‚æ­¥å‰¯ä½œç”¨ï¼Œå¦‚è¯·æ±‚æ•°æ®</td></tr><tr><td><code>useLayoutEffect</code></td><td>åœ¨ DOM æ›´æ–°åã€ç»˜åˆ¶å‰</td><td>åŒæ­¥ DOM æ“ä½œ</td></tr><tr><td><strong><code>useInsertionEffect</code></strong></td><td><strong>åœ¨ React ä¿®æ”¹ DOM ä¹‹å‰</strong></td><td><strong>æ’å…¥æ ·å¼ã€ç¡®ä¿æ ·å¼ä¼˜å…ˆ</strong></td></tr></tbody></table><p>ğŸ“Š <strong>æ‰§è¡Œé¡ºåºï¼ˆReact æ¸²æŸ“é˜¶æ®µï¼‰</strong>ï¼š</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Render Phase</span></span>
<span class="line"><span>  â†“</span></span>
<span class="line"><span>useInsertionEffect âœ… (æ ·å¼æ³¨å…¥)</span></span>
<span class="line"><span>  â†“</span></span>
<span class="line"><span>DOM mutations (æ’å…¥çœŸå® DOM)</span></span>
<span class="line"><span>  â†“</span></span>
<span class="line"><span>useLayoutEffect</span></span>
<span class="line"><span>  â†“</span></span>
<span class="line"><span>Browser Paint (é¡µé¢ç»˜åˆ¶)</span></span>
<span class="line"><span>  â†“</span></span>
<span class="line"><span>useEffect</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="å››ã€å®é™…ä¾‹å­-æ¨¡æ‹Ÿ-css-in-js-æ³¨å…¥" tabindex="-1">å››ã€å®é™…ä¾‹å­ï¼šæ¨¡æ‹Ÿ CSS-in-JS æ³¨å…¥ <a class="header-anchor" href="#å››ã€å®é™…ä¾‹å­-æ¨¡æ‹Ÿ-css-in-js-æ³¨å…¥" aria-label="Permalink to &quot;å››ã€å®é™…ä¾‹å­ï¼šæ¨¡æ‹Ÿ CSS-in-JS æ³¨å…¥&quot;">â€‹</a></h2><p>æ¥çœ‹ä¸€ä¸ªç®€åŒ–çš„ä¾‹å­ï¼š</p><div class="language-jsx vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> React, { useInsertionEffect } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;react&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useStyle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">cssText</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  useInsertionEffect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> style</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;style&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    style.textContent </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cssText;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    document.head.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">appendChild</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(style);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> document.head.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">removeChild</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(style);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }, [cssText]);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Box</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  useStyle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    .box {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      background: #4f46e5;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      color: white;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      padding: 10px;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      border-radius: 8px;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    }</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  \`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> className</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;box&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;Hello useInsertionEffect&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Box;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>âœ… æ•ˆæœï¼š</p><ul><li>æ ·å¼ä¼šåœ¨ DOM åˆ›å»ºä¹‹å‰æ³¨å…¥ï¼›</li><li>é¡µé¢æ¸²æŸ“æ—¶ä¸ä¼šå‡ºç°é—ªçƒï¼›</li><li>æ ·å¼æ’å…¥é¡ºåºå®Œå…¨å¯æ§ã€‚</li></ul><h2 id="äº”ã€ä¸-uselayouteffect-çš„åŒºåˆ«" tabindex="-1">äº”ã€ä¸ useLayoutEffect çš„åŒºåˆ« <a class="header-anchor" href="#äº”ã€ä¸-uselayouteffect-çš„åŒºåˆ«" aria-label="Permalink to &quot;äº”ã€ä¸ useLayoutEffect çš„åŒºåˆ«&quot;">â€‹</a></h2><table tabindex="0"><thead><tr><th>ç‰¹æ€§</th><th>useLayoutEffect</th><th>useInsertionEffect</th></tr></thead><tbody><tr><td>æ‰§è¡Œæ—¶æœº</td><td>DOM æ›´æ–°åã€ç»˜åˆ¶å‰</td><td><strong>DOM æ›´æ–°å‰</strong></td></tr><tr><td>æ˜¯å¦å¯æ“ä½œ DOM</td><td>âœ… å¯ä»¥</td><td>âŒ ä¸æ¨èï¼ˆDOM å°šæœªç”Ÿæˆï¼‰</td></tr><tr><td>ç”¨é€”</td><td>è¯»å–æˆ–ä¿®æ”¹å¸ƒå±€</td><td>æ’å…¥æ ·å¼ã€ç”Ÿæˆ CSS</td></tr><tr><td>ä½¿ç”¨åœºæ™¯</td><td>åŠ¨ç”»ã€æµ‹é‡</td><td>CSS-in-JS æ ·å¼æ³¨å…¥</td></tr></tbody></table><p>ğŸš« æ³¨æ„ï¼š <code>useInsertionEffect</code> ä¸èƒ½æ“ä½œ DOMï¼ˆå› ä¸ºæ­¤æ—¶ DOM è¿˜æ²¡ç”Ÿæˆï¼‰ï¼Œ å®ƒ<strong>åªé€‚åˆåšâ€œæ ·å¼æ’å…¥â€ç±»å‰¯ä½œç”¨</strong>ã€‚</p><h2 id="å…­ã€ä¸ºä»€ä¹ˆ-react-è¦å•ç‹¬ä¸ºæ ·å¼è®¾è®¡ä¸€ä¸ª-hook" tabindex="-1">å…­ã€ä¸ºä»€ä¹ˆ React è¦å•ç‹¬ä¸ºæ ·å¼è®¾è®¡ä¸€ä¸ª Hookï¼Ÿ <a class="header-anchor" href="#å…­ã€ä¸ºä»€ä¹ˆ-react-è¦å•ç‹¬ä¸ºæ ·å¼è®¾è®¡ä¸€ä¸ª-hook" aria-label="Permalink to &quot;å…­ã€ä¸ºä»€ä¹ˆ React è¦å•ç‹¬ä¸ºæ ·å¼è®¾è®¡ä¸€ä¸ª Hookï¼Ÿ&quot;">â€‹</a></h2><p>React å®˜æ–¹åœ¨ <a href="https://github.com/reactjs/rfcs/pull/221" target="_blank" rel="noreferrer">RFC ææ¡ˆ</a> ä¸­è§£é‡Šï¼š</p><blockquote><p>ä¸ºäº†æ”¯æŒâ€œå¹¶å‘æ¸²æŸ“â€ï¼Œå¿…é¡»åœ¨æ¸²æŸ“é˜¶æ®µç¡®ä¿æ ·å¼èƒ½ä¸ç»„ä»¶åŒæ­¥ã€‚ å¦‚æœæ ·å¼æ’å…¥åœ¨ DOM æ›´æ–°ä¹‹åï¼ˆä¾‹å¦‚åœ¨ <code>useLayoutEffect</code>ï¼‰ï¼Œå¯èƒ½å¯¼è‡´æ ·å¼é—ªçƒã€‚</p></blockquote><p>ä¸¾ä¸ªä¾‹å­ğŸ‘‡</p><div class="language-jsx vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> App</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dark</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">setDark</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">button</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> onClick</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> setDark</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> !</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">d)}&gt;åˆ‡æ¢ä¸»é¢˜&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">button</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ThemeBox</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> dark</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{dark} /&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ThemeBox</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">dark</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  useInsertionEffect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> style</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;style&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    style.textContent </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> \`.box { background: \${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dark</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ?</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;#000&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;#fff&quot;} }\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    document.head.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">appendChild</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(style);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> document.head.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">removeChild</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(style);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }, [dark]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> className</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;box&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;Hello&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>å½“ä¸»é¢˜åˆ‡æ¢æ—¶ï¼Œæ ·å¼ä¼šåœ¨ DOM æ›´æ–°å‰å°±æ³¨å…¥ï¼Œ <strong>React èƒ½ä¿è¯æ–°æ ·å¼ä¸æ–°ç»„ä»¶ä¸€åŒå‘ˆç°ï¼Œé¿å…äº†é—ªçƒã€‚</strong></p><h2 id="ä¸ƒã€åœ¨æ¡†æ¶ä¸­çš„å®é™…åº”ç”¨" tabindex="-1">ä¸ƒã€åœ¨æ¡†æ¶ä¸­çš„å®é™…åº”ç”¨ <a class="header-anchor" href="#ä¸ƒã€åœ¨æ¡†æ¶ä¸­çš„å®é™…åº”ç”¨" aria-label="Permalink to &quot;ä¸ƒã€åœ¨æ¡†æ¶ä¸­çš„å®é™…åº”ç”¨&quot;">â€‹</a></h2><p>è®¸å¤š CSS-in-JS åº“éƒ½åœ¨å†…éƒ¨ä½¿ç”¨äº†å®ƒï¼š</p><table tabindex="0"><thead><tr><th>åº“</th><th>æ˜¯å¦ä½¿ç”¨ useInsertionEffect</th><th>ç”¨é€”</th></tr></thead><tbody><tr><td>Emotion</td><td>âœ… æ˜¯</td><td>åŠ¨æ€æ’å…¥ <code>&lt;style&gt;</code> æ ‡ç­¾</td></tr><tr><td>Styled-components v6+</td><td>âœ… æ˜¯</td><td>ç¡®ä¿ SSR ä¸æ ·å¼é¡ºåºä¸€è‡´</td></tr><tr><td>Jotai / Zustand</td><td>âŒ å¦</td><td>çŠ¶æ€ç®¡ç†åº“ï¼Œä¸æ¶‰åŠæ ·å¼</td></tr><tr><td>Tailwind CSS</td><td>âŒ å¦</td><td>ä½¿ç”¨ç¼–è¯‘æ—¶é™æ€ç±»å</td></tr></tbody></table><p>ğŸ’¡ å¯¹äºæˆ‘ä»¬æ™®é€šå¼€å‘è€…ï¼Œå‡ ä¹ä¸éœ€è¦æ‰‹åŠ¨å†™å®ƒï¼Œ ä½†ç†è§£å®ƒèƒ½å¸®ä½ ç†è§£ CSS-in-JS æ¡†æ¶å¦‚ä½•â€œæ— é—ªçƒæ¸²æŸ“æ ·å¼â€ã€‚</p>`,33))])}const F=n(k,[["render",d]]);export{b as __pageData,F as default};
