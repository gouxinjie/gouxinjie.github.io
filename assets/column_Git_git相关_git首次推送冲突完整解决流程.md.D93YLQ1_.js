import{_ as e,C as t,c as n,o as l,j as a,G as r,aQ as p,a as d}from"./chunks/framework.DEi4YP2n.js";const E=JSON.parse('{"title":"Git 首次推送冲突完整解决流程（新手常遇到）","description":"","frontmatter":{},"headers":[],"relativePath":"column/Git/git相关/git首次推送冲突完整解决流程.md","filePath":"column/Git/git相关/git首次推送冲突完整解决流程.md","lastUpdated":1764148425000}'),h={name:"column/Git/git相关/git首次推送冲突完整解决流程.md"};function o(c,s,k,g,u,b){const i=t("ArticleMetadata");return l(),n("div",null,[s[0]||(s[0]=a("h1",{id:"git-首次推送冲突完整解决流程-新手常遇到",tabindex:"-1"},[d("Git 首次推送冲突完整解决流程（新手常遇到） "),a("a",{class:"header-anchor",href:"#git-首次推送冲突完整解决流程-新手常遇到","aria-label":'Permalink to "Git 首次推送冲突完整解决流程（新手常遇到）"'},"​")],-1)),r(i),s[1]||(s[1]=p(`<nav class="table-of-contents"><ul><li><a href="#_1️-建立远程连接">1️. 建立远程连接</a></li><li><a href="#_2-确保本地已提交">2. 确保本地已提交</a></li><li><a href="#_3-拉取远程历史-允许无关历史">3. 拉取远程历史（允许无关历史）</a></li><li><a href="#_4-标记冲突已解决并继续">4. 标记冲突已解决并继续</a></li><li><a href="#_5-推送合并后的历史">5. 推送合并后的历史</a></li><li><a href="#_6-后续日常开发">6. 后续日常开发</a></li><li><a href="#常用应急命令">常用应急命令</a></li></ul></nav><p><strong>场景描述</strong></p><ul><li>本地已有代码并执行过 <code>git commit</code></li><li>远程仓库（GitLab）的 <code>main</code> 创建分支时已存在初始提交（README、.gitignore 等）</li><li>直接 <code>git push</code> 被拒绝：<br><code>! [rejected] main -&gt; main (non-fast-forward)</code></li><li>受保护分支<strong>禁止强制推送</strong>，必须保留两段历史</li></ul><h2 id="_1️-建立远程连接" tabindex="-1">1️. 建立远程连接 <a class="header-anchor" href="#_1️-建立远程连接" aria-label="Permalink to &quot;1️. 建立远程连接&quot;">​</a></h2><div class="language-powershell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">git remote </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">set-url</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> origin 分支地址</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="_2-确保本地已提交" tabindex="-1">2. 确保本地已提交 <a class="header-anchor" href="#_2-确保本地已提交" aria-label="Permalink to &quot;2. 确保本地已提交&quot;">​</a></h2><div class="language-powershell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">git add .</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">git commit </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">m </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Initial commit&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>很多新手在这个时候下面会直接执行 <code>git push</code>，但是会被拒绝。更换强制命令为：</p><div class="language-powershell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">git push </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u origin main </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">force</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>也是会被拒绝，因为新建仓库时 main 或者是 master 分支是默认分支，同时也是受保护分支<strong>禁止强制推送</strong>，必须保留两段历史。</p><p>所以要先拉取远程历史，合并后再推送。如下步骤3：</p><h2 id="_3-拉取远程历史-允许无关历史" tabindex="-1">3. 拉取远程历史（允许无关历史） <a class="header-anchor" href="#_3-拉取远程历史-允许无关历史" aria-label="Permalink to &quot;3. 拉取远程历史（允许无关历史）&quot;">​</a></h2><div class="language-powershell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">git pull origin main </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">allow</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">unrelated</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">histories</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><strong>可能出现冲突</strong> → 按提示打开文件解决，然后：</p><h2 id="_4-标记冲突已解决并继续" tabindex="-1">4. 标记冲突已解决并继续 <a class="header-anchor" href="#_4-标记冲突已解决并继续" aria-label="Permalink to &quot;4. 标记冲突已解决并继续&quot;">​</a></h2><div class="language-powershell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">git add .</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">git rebase </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">continue        </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 继续应用剩余提交</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><blockquote><p>若还有冲突，重复 <strong>解决 → add → --continue</strong> 直至完成。</p></blockquote><h2 id="_5-推送合并后的历史" tabindex="-1">5. 推送合并后的历史 <a class="header-anchor" href="#_5-推送合并后的历史" aria-label="Permalink to &quot;5. 推送合并后的历史&quot;">​</a></h2><div class="language-powershell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">git push </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u origin main</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>成功后会看到 <code>Total xxx (delta yyy)</code>，远程即包含本地与远程两段历史。</p><h2 id="_6-后续日常开发" tabindex="-1">6. 后续日常开发 <a class="header-anchor" href="#_6-后续日常开发" aria-label="Permalink to &quot;6. 后续日常开发&quot;">​</a></h2><div class="language-powershell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">git pull </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rebase   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 拉新代码</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">git push            </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 推送，无需再 -u</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="常用应急命令" tabindex="-1">常用应急命令 <a class="header-anchor" href="#常用应急命令" aria-label="Permalink to &quot;常用应急命令&quot;">​</a></h2><table tabindex="0"><thead><tr><th>操作</th><th>命令</th></tr></thead><tbody><tr><td>放弃本次 rebase</td><td><code>git rebase --abort</code></td></tr><tr><td>跳过当前冲突提交</td><td><code>git rebase --skip</code></td></tr><tr><td>查看状态</td><td><code>git status</code></td></tr><tr><td>查看远程地址</td><td><code>git remote -v</code></td></tr></tbody></table><p><strong>结论</strong><br> 在<strong>受保护分支</strong>环境下，<strong>禁止 <code>push -f</code></strong>；必须通过</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>git pull origin main --allow-unrelated-histories</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>把两段无关历史合并，再正常推送即可。</p>`,27))])}const v=e(h,[["render",o]]);export{E as __pageData,v as default};
