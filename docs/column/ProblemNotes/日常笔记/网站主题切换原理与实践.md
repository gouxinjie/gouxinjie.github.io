# ç½‘ç«™ä¸»é¢˜åˆ‡æ¢åŸç†ä¸å®è·µï¼šCSS ç±»ååˆ‡æ¢æ–¹æ¡ˆ

[[toc]]

åœ¨ç°ä»£ Web å¼€å‘ä¸­ï¼Œä¸ºç”¨æˆ·æä¾›ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½å·²ç»æˆä¸ºæå‡ç”¨æˆ·ä½“éªŒçš„é‡è¦æ–¹å¼ã€‚æ— è®ºæ˜¯æµ…è‰²/æ·±è‰²ä¸»é¢˜åˆ‡æ¢ï¼Œè¿˜æ˜¯å¤šè‰²å½©ä¸»é¢˜é€‰æ‹©ï¼Œéƒ½èƒ½è®©ç”¨æˆ·æ ¹æ®è‡ªå·±çš„åå¥½å’Œç¯å¢ƒé€‰æ‹©æœ€èˆ’é€‚çš„ç•Œé¢ã€‚

**å®ç°æ•ˆæœ**

![ä¸»é¢˜åˆ‡æ¢æ•ˆæœ](../images/theme-switch.gif)

## ä¸€ã€æ ¸å¿ƒåŸç†

ä¸»é¢˜åˆ‡æ¢çš„æ ¸å¿ƒåŸç†æ˜¯é€šè¿‡æ”¹å˜ HTML å…ƒç´ çš„ CSS ç±»åï¼Œä»è€Œåº”ç”¨ä¸åŒçš„æ ·å¼è§„åˆ™ã€‚å…·ä½“æ¥è¯´ï¼š

1. **å®šä¹‰å¤šä¸ªä¸»é¢˜æ ·å¼**ï¼šä¸ºæ¯ä¸ªä¸»é¢˜åˆ›å»ºå¯¹åº”çš„ CSS ç±»
2. **åŠ¨æ€åˆ‡æ¢ç±»å**ï¼šä½¿ç”¨ JavaScript åœ¨è¿è¡Œæ—¶åˆ‡æ¢ HTML å…ƒç´ çš„ç±»å
3. **æ ·å¼çº§è”åº”ç”¨**ï¼šåˆ©ç”¨ CSS çš„çº§è”ç‰¹æ€§ï¼Œæ–°ç±»åçš„æ ·å¼ä¼šè¦†ç›–é»˜è®¤æ ·å¼

## äºŒã€å®ç°æ–¹æ¡ˆ

### 1. CSS ä¸»é¢˜å®šä¹‰

é¦–å…ˆï¼Œæˆ‘ä»¬ä¸ºæ¯ä¸ªä¸»é¢˜å®šä¹‰ä¸€å¥—å®Œæ•´çš„ CSS å˜é‡ï¼š

```css
/* æµ…è‰²ä¸»é¢˜ */
.theme-light {
  --primary-bg: #ffffff;
  --secondary-bg: #f8f9fa;
  --primary-text: #212529;
  --accent-color: #007bff;
  --border-color: #dee2e6;
}

/* æ·±è‰²ä¸»é¢˜ */
.theme-dark {
  --primary-bg: #121212;
  --secondary-bg: #1e1e1e;
  --primary-text: #e9ecef;
  --accent-color: #4dabf7;
  --border-color: #495057;
}

/* åº”ç”¨ä¸»é¢˜å˜é‡ */
body {
  background-color: var(--primary-bg);
  color: var(--primary-text);
  transition: all 0.3s ease;
}
```

### 2. HTML ç»“æ„

åœ¨ HTML ä¸­ï¼Œæˆ‘ä»¬è®¾ç½®é»˜è®¤ä¸»é¢˜å¹¶åˆ›å»ºä¸»é¢˜åˆ‡æ¢æ§ä»¶ï¼š

```html
<body class="theme-light">
  <header>
    <div class="theme-switcher">
      <button class="theme-btn active" data-theme="theme-light">æµ…è‰²</button>
      <button class="theme-btn" data-theme="theme-dark">æ·±è‰²</button>
    </div>
  </header>
  <!-- é¡µé¢å†…å®¹ -->
</body>
```

### 3. JavaScript åˆ‡æ¢é€»è¾‘

å®ç°ä¸»é¢˜åˆ‡æ¢çš„æ ¸å¿ƒ JavaScript ä»£ç ï¼š

```javascript
class ThemeManager {
  constructor() {
    this.body = document.body;
    this.themeButtons = document.querySelectorAll(".theme-btn");
    this.init();
  }

  init() {
    // åŠ è½½ä¿å­˜çš„ä¸»é¢˜
    this.loadTheme();
    // ç»‘å®šäº‹ä»¶
    this.bindEvents();
    // ç›‘å¬ç³»ç»Ÿä¸»é¢˜å˜åŒ–
    this.watchSystemTheme();
  }

  bindEvents() {
    this.themeButtons.forEach((button) => {
      button.addEventListener("click", (e) => {
        const theme = e.target.dataset.theme;
        this.setTheme(theme);
      });
    });
  }

  setTheme(theme) {
    // ç§»é™¤æ‰€æœ‰ä¸»é¢˜ç±»
    this.body.classList.remove("theme-light", "theme-dark");
    // æ·»åŠ æ–°ä¸»é¢˜ç±»
    this.body.classList.add(theme);

    // æ›´æ–°æŒ‰é’®çŠ¶æ€
    this.updateButtonStates(theme);

    // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
    this.saveTheme(theme);
  }

  updateButtonStates(activeTheme) {
    this.themeButtons.forEach((button) => {
      button.classList.toggle("active", button.dataset.theme === activeTheme);
    });
  }

  saveTheme(theme) {
    localStorage.setItem("user-theme", theme);
  }

  loadTheme() {
    const savedTheme = localStorage.getItem("user-theme");
    if (savedTheme) {
      this.setTheme(savedTheme);
    }
  }

  watchSystemTheme() {
    if (window.matchMedia) {
      const mediaQuery = window.matchMedia("(prefers-color-scheme: dark)");

      mediaQuery.addEventListener("change", (e) => {
        // åªæœ‰ç”¨æˆ·æ²¡æœ‰æ‰‹åŠ¨é€‰æ‹©æ—¶æ‰è·Ÿéšç³»ç»Ÿ
        if (!localStorage.getItem("user-theme")) {
          this.setTheme(e.matches ? "theme-dark" : "theme-light");
        }
      });
    }
  }
}

// åˆå§‹åŒ–ä¸»é¢˜ç®¡ç†å™¨
new ThemeManager();
```

## ä¸‰ã€å…³é”®æŠ€æœ¯ç»†èŠ‚

### 1. CSS å˜é‡ï¼ˆè‡ªå®šä¹‰å±æ€§ï¼‰çš„ä½¿ç”¨

CSS å˜é‡è®©æˆ‘ä»¬èƒ½å¤Ÿé›†ä¸­ç®¡ç†ä¸»é¢˜ç›¸å…³çš„é¢œè‰²ã€é—´è·ç­‰å€¼ï¼š

```css
:root {
  --transition-duration: 0.3s;
  --border-radius: 8px;
}

.theme-light {
  --primary-bg: #ffffff;
  --text-color: #333333;
}

.theme-dark {
  --primary-bg: #1a1a1a;
  --text-color: #ffffff;
}

.component {
  background: var(--primary-bg);
  color: var(--text-color);
  transition: all var(--transition-duration) ease;
}
```

### 2. å¹³æ»‘è¿‡æ¸¡æ•ˆæœ

é€šè¿‡ CSS transition å®ç°ä¸»é¢˜åˆ‡æ¢æ—¶çš„å¹³æ»‘åŠ¨ç”»ï¼š

```css
* {
  transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
}
```

### 3. æŒä¹…åŒ–å­˜å‚¨

ä½¿ç”¨ localStorage ä¿å­˜ç”¨æˆ·é€‰æ‹©ï¼Œç¡®ä¿åˆ·æ–°é¡µé¢åä¸»é¢˜ä¿æŒä¸€è‡´ï¼š

```javascript
saveTheme(theme) {
    localStorage.setItem('user-theme', theme);
}

loadTheme() {
    return localStorage.getItem('user-theme') || 'theme-light';
}
```

### 4. ç³»ç»Ÿä¸»é¢˜æ£€æµ‹

è‡ªåŠ¨æ£€æµ‹ç”¨æˆ·æ“ä½œç³»ç»Ÿçš„ä¸»é¢˜åå¥½ï¼š

```javascript
watchSystemTheme() {
    if (window.matchMedia) {
        const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');

        // åˆå§‹æ£€æµ‹
        if (!localStorage.getItem('user-theme')) {
            this.setTheme(mediaQuery.matches ? 'theme-dark' : 'theme-light');
        }

        // ç›‘å¬å˜åŒ–
        mediaQuery.addEventListener('change', (e) => {
            if (!localStorage.getItem('user-theme')) {
                this.setTheme(e.matches ? 'theme-dark' : 'theme-light');
            }
        });
    }
}
```

## å››ã€è¿›é˜¶åŠŸèƒ½

### 1. ä¸»é¢˜æ‰©å±•æ€§

è½»æ¾æ·»åŠ æ–°ä¸»é¢˜ï¼š

```css
.theme-blue {
  --primary-bg: #e3f2fd;
  --accent-color: #2196f3;
  --text-color: #0d47a1;
}

.theme-green {
  --primary-bg: #e8f5e8;
  --accent-color: #4caf50;
  --text-color: #1b5e20;
}
```

### 2. ç»„ä»¶çº§ä¸»é¢˜æ”¯æŒ

ä¸ºç‰¹å®šç»„ä»¶è®¾ç½®ä¸»é¢˜ï¼š

```css
.card {
  background: var(--card-bg, var(--secondary-bg));
  border: 1px solid var(--card-border, var(--border-color));
}

.theme-dark .card {
  --card-bg: #2d2d2d;
  --card-border: #404040;
}
```

### 3. æ€§èƒ½ä¼˜åŒ–

é¿å…ä¸å¿…è¦çš„é‡ç»˜å’Œå›æµï¼š

```javascript
setTheme(theme) {
    // ä½¿ç”¨requestAnimationFrameä¼˜åŒ–æ€§èƒ½
    requestAnimationFrame(() => {
        this.body.classList.remove(...this.body.classList);
        this.body.classList.add(theme);
    });
}
```

## äº”ã€æœ€ä½³å®è·µ

1. **æ¸è¿›å¢å¼º**ï¼šç¡®ä¿åœ¨æ²¡æœ‰ JavaScript çš„æƒ…å†µä¸‹ï¼Œé»˜è®¤ä¸»é¢˜ä»èƒ½æ­£å¸¸å·¥ä½œ
2. **æ— éšœç¢è®¿é—®**ï¼šä¸ºä¸»é¢˜åˆ‡æ¢æŒ‰é’®æä¾›é€‚å½“çš„ ARIA æ ‡ç­¾
3. **æ€§èƒ½è€ƒè™‘**ï¼šé¿å…åœ¨ä¸»é¢˜åˆ‡æ¢æ—¶è¿›è¡Œå¤æ‚çš„ DOM æ“ä½œ
4. **æµ‹è¯•è¦†ç›–**ï¼šåœ¨ä¸åŒè®¾å¤‡å’Œæµè§ˆå™¨ä¸Šæµ‹è¯•ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½
5. **ç”¨æˆ·åé¦ˆ**ï¼šåœ¨åˆ‡æ¢ä¸»é¢˜æ—¶æä¾›è§†è§‰åé¦ˆ

## æ¡ˆä¾‹æºç 

```html
<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CSSç±»åä¸»é¢˜åˆ‡æ¢</title>
    <style>
      /* åŸºç¡€æ ·å¼ */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        /* å®ç°é¢œè‰²çš„è¿‡æ¸¡æ•ˆæœ */
        transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        line-height: 1.6;
        background-color: #ffffff;
        color: #333333;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }

      /* æµ…è‰²ä¸»é¢˜ - é»˜è®¤ */
      .theme-light {
        --primary-bg: #ffffff;
        --secondary-bg: #f8f9fa;
        --primary-text: #212529;
        --secondary-text: #6c757d;
        --accent-color: #007bff;
        --border-color: #dee2e6;
        --card-bg: #ffffff;
        --shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
      }

      /* æ·±è‰²ä¸»é¢˜ */
      .theme-dark {
        --primary-bg: #121212;
        --secondary-bg: #1e1e1e;
        --primary-text: #e9ecef;
        --secondary-text: #adb5bd;
        --accent-color: #4dabf7;
        --border-color: #495057;
        --card-bg: #2d2d2d;
        --shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.5);
      }

      /* è“è‰²ä¸»é¢˜ */
      .theme-blue {
        --primary-bg: #e3f2fd;
        --secondary-bg: #bbdefb;
        --primary-text: #0d47a1;
        --secondary-text: #1565c0;
        --accent-color: #2196f3;
        --border-color: #90caf9;
        --card-bg: #ffffff;
        --shadow: 0 0.125rem 0.25rem rgba(33, 150, 243, 0.3);
      }

      /* åº”ç”¨ä¸»é¢˜å˜é‡ */
      body {
        background-color: var(--primary-bg);
        color: var(--primary-text);
      }

      /* å¤´éƒ¨æ ·å¼ */
      header {
        background-color: var(--secondary-bg);
        padding: 1rem 0;
        border-bottom: 1px solid var(--border-color);
        box-shadow: var(--shadow);
      }

      .header-content {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .logo {
        font-size: 1.5rem;
        font-weight: bold;
        color: var(--accent-color);
      }

      .theme-switcher {
        display: flex;
        gap: 10px;
      }

      .theme-btn {
        padding: 8px 16px;
        border: 1px solid var(--border-color);
        border-radius: 4px;
        background-color: var(--card-bg);
        color: var(--primary-text);
        cursor: pointer;
        transition: all 0.2s;
      }

      .theme-btn:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow);
      }

      .theme-btn.active {
        background-color: var(--accent-color);
        color: white;
        border-color: var(--accent-color);
      }

      /* ä¸»å†…å®¹åŒºåŸŸ */
      main {
        padding: 2rem 0;
      }

      .card-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin-top: 2rem;
      }

      .card {
        background-color: var(--card-bg);
        border-radius: 8px;
        padding: 1.5rem;
        box-shadow: var(--shadow);
        border: 1px solid var(--border-color);
      }

      .card h3 {
        color: var(--accent-color);
        margin-bottom: 1rem;
      }

      .card p {
        color: var(--secondary-text);
        margin-bottom: 1rem;
      }

      /* ç‰¹æ€§å±•ç¤º */
      .features {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 15px;
        margin-top: 1.5rem;
      }

      .feature {
        padding: 1rem;
        background-color: var(--secondary-bg);
        border-radius: 6px;
        text-align: center;
      }

      .feature-icon {
        font-size: 2rem;
        margin-bottom: 0.5rem;
      }

      /* é¡µè„š */
      footer {
        background-color: var(--secondary-bg);
        padding: 1.5rem 0;
        border-top: 1px solid var(--border-color);
        margin-top: 3rem;
        text-align: center;
        color: var(--secondary-text);
      }

      /* å“åº”å¼è®¾è®¡ */
      @media (max-width: 768px) {
        .header-content {
          flex-direction: column;
          gap: 1rem;
        }

        .theme-switcher {
          width: 100%;
          justify-content: center;
        }
      }
    </style>
  </head>
  <body class="theme-light">
    <div class="container">
      <header>
        <div class="header-content">
          <div class="logo">ç½‘ç«™ä¸»é¢˜åˆ‡æ¢</div>
          <div class="theme-switcher">
            <button class="theme-btn active" data-theme="theme-light">æµ…è‰²ä¸»é¢˜</button>
            <button class="theme-btn" data-theme="theme-dark">æ·±è‰²ä¸»é¢˜</button>
            <button class="theme-btn" data-theme="theme-blue">è“è‰²ä¸»é¢˜</button>
          </div>
        </div>
      </header>

      <main>
        <div class="card">
          <h2>CSSç±»åä¸»é¢˜åˆ‡æ¢å®ç°</h2>
          <p>è¿™ä¸ªç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨CSSç±»åæ¥å®ç°ç½‘ç«™ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½ã€‚</p>

          <div class="features">
            <div class="feature">
              <div class="feature-icon">ğŸ¨</div>
              <h3>å¤šä¸»é¢˜æ”¯æŒ</h3>
              <p>è½»æ¾æ·»åŠ æ–°çš„ä¸»é¢˜æ ·å¼</p>
            </div>
            <div class="feature">
              <div class="feature-icon">âš¡</div>
              <h3>å¿«é€Ÿåˆ‡æ¢</h3>
              <p>å³æ—¶åº”ç”¨ä¸»é¢˜å˜åŒ–</p>
            </div>
            <div class="feature">
              <div class="feature-icon">ğŸ’¾</div>
              <h3>è®°å¿†åå¥½</h3>
              <p>è‡ªåŠ¨ä¿å­˜ç”¨æˆ·é€‰æ‹©</p>
            </div>
          </div>
        </div>

        <div class="card-grid">
          <div class="card">
            <h3>å®ç°åŸç†</h3>
            <p>é€šè¿‡ä¸ºbodyå…ƒç´ æ·»åŠ ä¸åŒçš„CSSç±»åæ¥åˆ‡æ¢æ•´ä¸ªé¡µé¢çš„ä¸»é¢˜æ ·å¼ã€‚</p>
            <p>æ¯ä¸ªä¸»é¢˜ç±»å®šä¹‰äº†ä¸€å¥—å®Œæ•´çš„CSSå˜é‡ï¼Œæ§åˆ¶é¢œè‰²ã€é˜´å½±ç­‰è§†è§‰å±æ€§ã€‚</p>
          </div>

          <div class="card">
            <h3>æ ¸å¿ƒä¼˜åŠ¿</h3>
            <p>â€¢ ä»£ç ç»“æ„æ¸…æ™°ï¼Œæ˜“äºç»´æŠ¤</p>
            <p>â€¢ æ”¯æŒä¸»é¢˜çš„çµæ´»æ‰©å±•</p>
            <p>â€¢ è‰¯å¥½çš„æµè§ˆå™¨å…¼å®¹æ€§</p>
            <p>â€¢ å¹³æ»‘çš„è¿‡æ¸¡åŠ¨ç”»æ•ˆæœ</p>
          </div>

          <div class="card">
            <h3>ä½¿ç”¨åœºæ™¯</h3>
            <p>â€¢ éœ€è¦å¤šä¸»é¢˜æ”¯æŒçš„Webåº”ç”¨</p>
            <p>â€¢ å…³æ³¨ç”¨æˆ·ä½“éªŒçš„ç½‘ç«™</p>
            <p>â€¢ éœ€è¦è·Ÿéšç³»ç»Ÿä¸»é¢˜çš„åº”ç”¨</p>
            <p>â€¢ å“ç‰Œå¤šçš®è‚¤éœ€æ±‚çš„å¹³å°</p>
          </div>
        </div>
      </main>

      <footer>
        <p>&copy; 2024 ThemeSwitch ç¤ºä¾‹. æ‰€æœ‰ä¸»é¢˜åˆ‡æ¢å‡ä½¿ç”¨CSSç±»åå®ç°.</p>
      </footer>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const themeButtons = document.querySelectorAll(".theme-btn");
        const body = document.body;

        // ä»localStorageåŠ è½½ä¿å­˜çš„ä¸»é¢˜
        const savedTheme = localStorage.getItem("theme") || "theme-light";
        setTheme(savedTheme);

        // ä¸ºæ¯ä¸ªä¸»é¢˜æŒ‰é’®æ·»åŠ ç‚¹å‡»äº‹ä»¶
        themeButtons.forEach((button) => {
          button.addEventListener("click", function () {
            const theme = this.getAttribute("data-theme");
            setTheme(theme);

            // ä¿å­˜ç”¨æˆ·é€‰æ‹©åˆ°localStorage
            localStorage.setItem("theme", theme);
          });
        });

        function setTheme(theme) {
          console.log("theme:", theme);

          // ç§»é™¤æ‰€æœ‰ä¸»é¢˜ç±»
          body.classList.remove("theme-light", "theme-dark", "theme-blue");
          // æ·»åŠ å½“å‰ä¸»é¢˜ç±»
          body.classList.add(theme);

          // æ›´æ–°æŒ‰é’®çš„activeçŠ¶æ€
          themeButtons.forEach((button) => {
            if (button.getAttribute("data-theme") === theme) {
              button.classList.add("active");
            } else {
              button.classList.remove("active");
            }
          });
        }

        // ç›‘å¬ç³»ç»Ÿä¸»é¢˜å˜åŒ–ï¼ˆå¯é€‰åŠŸèƒ½ï¼‰
        if (window.matchMedia) {
          const darkModeMediaQuery = window.matchMedia("(prefers-color-scheme: dark)");

          darkModeMediaQuery.addEventListener("change", (e) => {
            // åªæœ‰å½“ç”¨æˆ·æ²¡æœ‰æ‰‹åŠ¨é€‰æ‹©ä¸»é¢˜æ—¶ï¼Œæ‰è·Ÿéšç³»ç»Ÿ
            if (!localStorage.getItem("theme")) {
              if (e.matches) {
                setTheme("theme-dark");
              } else {
                setTheme("theme-light");
              }
            }
          });
        }
      });
    </script>
  </body>
</html>
```
