
# Python ç±»å‹æ³¨è§£ï¼šä»èƒ½è·‘åˆ°ä¼˜é›…

> `Python` æ˜¯åŠ¨æ€è¯­è¨€ï¼Œä½†è¿™å¹¶ä¸æ„å‘³ç€ä½ åªèƒ½â€œéšç¼˜å†™ä»£ç â€ã€‚

ä» `Python 3.5` å¼€å§‹ï¼Œ**ç±»å‹æ³¨è§£ï¼ˆType Hintsï¼‰** æ­£å¼è¿›å…¥è¯­è¨€æ ¸å¿ƒã€‚
å®ƒ**ä¸å½±å“è¿è¡Œæ—¶**ï¼Œå´èƒ½æå¤§æå‡ï¼š

* å¯è¯»æ€§
* IDE æ™ºèƒ½æç¤º
* é™æ€æ£€æŸ¥èƒ½åŠ›
* å¤§å‹é¡¹ç›®çš„å¯ç»´æŠ¤æ€§

## ä¸€ã€ä»€ä¹ˆæ˜¯ Python ç±»å‹æ³¨è§£ï¼Ÿ

æœ€ç›´è§‚çš„ç†è§£ï¼š

> **ç»™å˜é‡ã€å‡½æ•°å‚æ•°ã€è¿”å›å€¼â€œè´´æ ‡ç­¾â€ï¼Œå‘Šè¯‰äººå’Œå·¥å…·ï¼šè¿™æ˜¯ä»€ä¹ˆç±»å‹**

```python
def add(a: int, b: int) -> int:
    return a + b
```

* `a: int`ï¼šå‚æ•°ç±»å‹
* `-> int`ï¼šè¿”å›å€¼ç±»å‹

âš ï¸ **é‡è¦ï¼šç±»å‹æ³¨è§£ä¸ä¼šå½±å“è¿è¡Œ**

```python
add("1", "2")  # è¿è¡Œæ—¶ä¸ä¼šæŠ¥é”™
```

Python è§£é‡Šå™¨ä¸ä¼šæ£€æŸ¥ç±»å‹ï¼Œ**æ£€æŸ¥çš„æ˜¯å·¥å…·ï¼ˆIDE / mypy / pyrightï¼‰**ã€‚

## äºŒã€ä¸ºä»€ä¹ˆè¦å†™ç±»å‹æ³¨è§£ï¼Ÿ

### 1ï¸âƒ£ IDE æ™ºèƒ½æç¤ºç›´æ¥èµ·é£ ğŸš€

```python
def get_name(user: dict) -> str:
    return user["name"]
```

IDE èƒ½å¸®ä½ ï¼š

* è‡ªåŠ¨è¡¥å…¨
* å‚æ•°æç¤º
* é‡æ„å®‰å…¨

### 2ï¸âƒ£ æå‰å‘ç° bugï¼ˆé™æ€æ£€æŸ¥ï¼‰

```python
def sum_list(nums: list[int]) -> int:
    return sum(nums)

sum_list(["1", "2"])  # âŒ é™æ€æ£€æŸ¥ç›´æ¥æŠ¥é”™
```

è¿è¡Œå‰å°±èƒ½å‘ç°é—®é¢˜ï¼Œè€Œä¸æ˜¯ç­‰åˆ°çº¿ä¸Šç‚¸ã€‚

### 3ï¸âƒ£ å¤§å‹é¡¹ç›®å¿…å¤‡ï¼ˆå°¤å…¶æ˜¯å¤šäººåä½œï¼‰

* ä¸ç”¨ç¿»å®ç°
* çœ‹ç­¾åå°±çŸ¥é“æ€ä¹ˆç”¨
* ç±»ä¼¼ **TypeScript å¯¹ JavaScript çš„ä»·å€¼**

## ä¸‰ã€åŸºç¡€ç±»å‹æ³¨è§£

### 1ï¸âƒ£ å†…ç½®åŸºç¡€ç±»å‹

```python
name: str = "Alice"
age: int = 18
height: float = 1.72
is_admin: bool = False
```

### 2ï¸âƒ£ å®¹å™¨ç±»å‹ï¼ˆPython 3.9+ æ¨èå†™æ³•ï¼‰

```python
numbers: list[int] = [1, 2, 3]
user: dict[str, str] = {"name": "Tom"}
tags: set[str] = {"python", "typing"}
point: tuple[int, int] = (10, 20)
```

ğŸ‘‰ **Python 3.9 ä¹‹å‰å†™æ³•**

```python
from typing import List, Dict, Tuple

numbers: List[int]
```

## å››ã€å‡½æ•°ç±»å‹æ³¨è§£ï¼ˆé‡ç‚¹ï¼‰

### 1ï¸âƒ£ å‚æ•° + è¿”å›å€¼

```python
def greet(name: str) -> str:
    return f"Hello {name}"
```

### 2ï¸âƒ£ æ²¡æœ‰è¿”å›å€¼

```python
def log(msg: str) -> None:
    print(msg)
```

`None` â‰  æ²¡å†™è¿”å›å€¼
ğŸ‘‰ è¡¨ç¤ºâ€œ**æ˜ç¡®ä¸è¿”å›ä»»ä½•ä¸œè¥¿**â€

### 3ï¸âƒ£ å¯é€‰å‚æ•°ï¼ˆOptionalï¼‰

```python
from typing import Optional

def get_user(id: int) -> Optional[str]:
    if id == 0:
        return None
    return "Tom"
```

ç­‰ä»·å†™æ³•ï¼ˆPython 3.10+ï¼‰ğŸ‘‡

```python
def get_user(id: int) -> str | None:
    ...
```

## äº”ã€Union / Literal / Any

### 1ï¸âƒ£ Unionï¼ˆå¤šç§ç±»å‹ä¹‹ä¸€ï¼‰

```python
from typing import Union

def parse_id(id: Union[int, str]) -> int:
    return int(id)
```

Python 3.10+ï¼š

```python
def parse_id(id: int | str) -> int:
    return int(id)
```

### 2ï¸âƒ£ Literalï¼ˆå­—é¢é‡ç±»å‹ï¼‰

```python
from typing import Literal

def set_theme(theme: Literal["light", "dark"]) -> None:
    ...
```

ğŸ‘‰ é€‚åˆ **é…ç½®é¡¹ / çŠ¶æ€å€¼**

### 3ï¸âƒ£ Anyï¼ˆæ…ç”¨ï¼‰

```python
from typing import Any

def parse(data: Any) -> Any:
    return data
```

âš ï¸ `Any` = æ”¾å¼ƒç±»å‹æ£€æŸ¥
ğŸ‘‰ **ä¸åˆ°ä¸‡ä¸å¾—å·²åˆ«ç”¨**

## å…­ã€ç±»å‹åˆ«åï¼ˆè®©ç±»å‹æ›´å¯è¯»ï¼‰

```python
User = dict[str, str]

def get_user() -> User:
    return {"name": "Tom"}
```

å¤æ‚ç±»å‹å°¤å…¶æœ‰ç”¨ï¼š

```python
Response = dict[str, int | str | bool]
```

## ä¸ƒã€TypedDictï¼ˆå­—å…¸ç»“æ„çº¦æŸï¼‰

æ™®é€š dict å¤ªå®½æ¾ï¼Ÿ

```python
from typing import TypedDict

class User(TypedDict):
    id: int
    name: str
    active: bool

def get_user() -> User:
    return {
        "id": 1,
        "name": "Tom",
        "active": True
    }
```

ğŸ‘‰ éå¸¸é€‚åˆï¼š

* JSON
* API è¿”å›å€¼
* é…ç½®å¯¹è±¡

## å…«ã€Class & æ–¹æ³•ç±»å‹æ³¨è§£

```python
class UserService:
    def __init__(self, name: str):
        self.name: str = name

    def get_name(self) -> str:
        return self.name
```

## ä¹ã€æ³›å‹ï¼ˆè¿›é˜¶ä½†å¾ˆé¦™ï¼‰

```python
from typing import TypeVar, Generic

T = TypeVar("T")

class Box(Generic[T]):
    def __init__(self, value: T):
        self.value = value

    def get(self) -> T:
        return self.value
```

ä½¿ç”¨ï¼š

```python
box = Box
box.get()  # æ¨æ–­ä¸º int
```

ğŸ‘‰ ç±»ä¼¼ TypeScript æ³›å‹


---

**æ‰©å±•èµ„æº**ï¼š
- [Python å®˜æ–¹ typing æ¨¡å—æ–‡æ¡£](https://docs.python.org/3/library/typing.html)
- [mypy æ–‡æ¡£](https://mypy.readthedocs.io/)
- [Python ç±»å‹æç¤ºæŒ‡å—](https://mypy.readthedocs.io/en/stable/cheat_sheet_py3.html)
- [Real Python ç±»å‹æç¤ºæ•™ç¨‹](https://realpython.com/python-type-checking/)
