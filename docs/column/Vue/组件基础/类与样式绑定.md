# Vue 类与样式绑定：灵活控制元素外观

## 一、Class 绑定

### 1. 对象语法

最常用的方式是通过对象语法动态切换 `class：`

```html
<div :class="{ active: isActive, 'text-danger': hasError }"></div>
```

对应的数据：

```javascript
data() {
  return {
    isActive: true,
    hasError: false
  }
}
```

### 2. 数组语法

可以将多个 `class` 放入数组中：

```html
<div :class="[activeClass, errorClass]"></div>
```

```javascript
data() {
  return {
    activeClass: 'active',
    errorClass: 'text-danger'
  }
}
```

### 3. 对象与数组混合

```html
<div :class="[{ active: isActive }, errorClass]"></div>
```

### 4. 组件上的 class

当在自定义组件上使用 `class` 时，这些 `class` 将被添加到组件的根元素上，且不会覆盖已有的 `class。`

## 二、Style 绑定

### 1. 对象语法

```html
<div :style="{ color: activeColor, fontSize: fontSize + 'px' }"></div>
```

```javascript
data() {
  return {
    activeColor: 'red',
    fontSize: 14
  }
}
```

### 2. 数组语法

可以将多个样式对象应用到同一个元素：

```html
<div :style="[baseStyles, overridingStyles]"></div>
```

### 3. 自动前缀

当使用需要浏览器前缀的 CSS 属性时（如 `transform`），Vue 会自动检测并添加适当的前缀。

### 4. 多重值

可以为 style 绑定中的属性提供一个包含多个值的数组：

```html
<div :style="{ display: ['-webkit-box', '-ms-flexbox', 'flex'] }"></div>
```

## 三、最佳实践

### 1. 组织复杂的 class 逻辑

当 class 逻辑变得复杂时，考虑使用计算属性：

```javascript
computed: {
  classObject() {
    return {
      active: this.isActive && !this.error,
      'text-danger': this.error && this.error.type === 'fatal'
    }
  }
}
```

### 2. 使用组件 props 控制样式

```javascript
props: {
  variant: {
    type: String,
    default: 'primary'
  }
},
computed: {
  buttonClasses() {
    return `btn btn-${this.variant}`
  }
}
```

### 3. 样式模块化

在单文件组件中，使用 `<style module>` 实现 CSS 模块化：

```html
<style module>
  .error {
    color: red;
  }
</style>

<template>
  <p :class="$style.error">错误信息</p>
</template>
```

### 4. 动态样式主题

通过 CSS 变量实现动态主题：

```javascript
data() {
  return {
    theme: {
      '--primary-color': '#42b983',
      '--secondary-color': '#35495e'
    }
  }
}
```

```html
<div :style="theme"></div>
```

## 四、常见问题解决方案

### 1. 条件 class 的简洁写法

使用工具函数简化 class 对象：

```javascript
// 工具函数
const classNames = (...args) =>
  args.filter(Boolean).join(' ')

// 使用
<div :class="classNames('base', isActive && 'active')"></div>
```

### 2. 响应式修改第三方组件的样式

使用深度选择器：

```css
/* 修改子组件样式 */
::v-deep .child-component {
  padding: 0;
}
```

### 3. 性能优化

避免在 style 绑定中使用复杂表达式，对于不变的样式，使用静态 class：

```html
<!-- 不推荐 -->
<div :style="{ width: width + 'px' }"></div>

<!-- 推荐 -->
<div :style="styleObject"></div>
```

```javascript
computed: {
  styleObject() {
    return {
      width: `${this.width}px`
    }
  }
}
```

## 五、实际应用案例

### 案例 1：动态导航菜单

```html
<nav>
  <a v-for="link in links" :key="link.id" :class="{ active: currentRoute === link.path }"> {{ link.text }} </a>
</nav>
```

### 案例 2：表单验证状态

```html
<input
  :class="{
    'is-valid': valid,
    'is-invalid': error,
    'is-pristine': pristine
  }"
/>
```

### 案例 3：响应式布局

```javascript
data() {
  return {
    screenWidth: window.innerWidth
  }
},
computed: {
  layoutClass() {
    return this.screenWidth < 768 ? 'mobile' : 'desktop'
  }
},
mounted() {
  window.addEventListener('resize', () => {
    this.screenWidth = window.innerWidth
  })
}
```