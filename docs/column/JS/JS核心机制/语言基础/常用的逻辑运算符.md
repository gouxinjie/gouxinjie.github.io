# JavaScript 中常用的逻辑运算符详解

逻辑运算符是 JavaScript 编程中最基础也是使用最频繁的运算符之一。它们不仅用于条件判断，还能通过短路求值实现简洁的代码逻辑。本文将全面介绍 JavaScript 中的逻辑运算符及其使用技巧。

## 一、基础逻辑运算符

### 1. 逻辑与 (&&)

**语法**：`expr1 && expr2`

**特性**：

- 当`expr1`可转换为`true`时，返回`expr2`
- 当`expr1`可转换为`false`时，返回`expr1`
- 短路求值：如果第一个操作数为假，不会计算第二个操作数

```javascript
console.log(true && false); // false
console.log(1 && 0); // 0
console.log(null && "hello"); // null
console.log("A" && "B"); // 'B'
```

**常见用途**：

- 条件执行：`isLogged && showDashboard()`
- 属性访问保护：`user && user.address && user.address.city`

### 2. 逻辑或 (||)

**语法**：`expr1 || expr2`

**特性**：

- 当`expr1`可转换为`true`时，返回`expr1`
- 当`expr1`可转换为`false`时，返回`expr2`
- 短路求值：如果第一个操作数为真，不会计算第二个操作数

```javascript
console.log(true || false); // true
console.log(0 || 1); // 1
console.log("" || "default"); // 'default'
console.log(NaN || null); // null
```

**常见用途**：

- 设置默认值：`const port = config.port || 3000`
- 回退方案：`const data = fetchData() || getCachedData()`

### 3. 逻辑非 (!)

**语法**：`!expr`

**特性**：

- 将操作数转换为布尔值后取反
- 双非(!!)可快速转换为布尔值

```javascript
console.log(!true); // false
console.log(!0); // true
console.log(!"hello"); // false
console.log(!!1); // true (双非转换)
```

## 二、进阶使用技巧

### 1. 短路求值应用

利用逻辑运算符的短路特性可以写出简洁的条件语句：

```javascript
// 代替简单的if语句
function greet(name) {
  name && console.log(`Hello, ${name}!`);
}

// 条件赋值
const value = maybeExists || calculateValue();
```

### 2. 默认参数处理（ES6 之前方式）

在 ES6 默认参数之前，常用逻辑或处理默认值：

```javascript
function connect(options) {
  const host = options.host || "localhost";
  const port = options.port || 8080;
  // ...
}
```

### 3. 安全访问嵌套属性

可选链操作符(?.)出现前的解决方案：

```javascript
const city = user && user.address && user.address.city;
// 等价于现代写法：user?.address?.city
```

## 三、ES6 新增逻辑运算符

### 1. 空值合并运算符 (??)

**语法**：`expr1 ?? expr2`

**特性**：

- 只有当`expr1`为`null`或`undefined`时才返回`expr2`
- 与`||`不同，不会对假值(falsy)如`0`、`''`、`false`等做出反应

```javascript
console.log(0 || 10); // 10
console.log(0 ?? 10); // 0

console.log("" || "default"); // 'default'
console.log("" ?? "default"); // ''
```

**适用场景**：

- 需要明确区分`null/undefined`和其他假值时
- 处理可能为`0`或空字符串的配置项

### 2. 逻辑赋值运算符 (ES2021)

结合逻辑运算符和赋值的简写形式：

```javascript
// 逻辑或赋值 (||=)
let x = 0;
x ||= 10; // x = x || 10 → 10

// 逻辑与赋值 (&&=)
let obj = { prop: 1 };
obj.prop &&= 2; // obj.prop = obj.prop && 2 → 2

// 空值合并赋值 (??=)
let config = { timeout: 0 };
config.timeout ??= 3000; // 保持0不变
```

## 四、实际应用示例

### 1. 表单验证

```javascript
function validate(form) {
  return (form.username && form.password) || alert("用户名和密码不能为空");
}
```

### 2. 条件渲染（React 示例）

```jsx
{
  (isLoading && <Spinner />) || (error && <ErrorMessage />) || <Content data={data} />;
}
```

### 3. 配置合并

```javascript
const defaultConfig = { duration: 300, easing: "linear" };
const userConfig = { duration: 500 };

const finalConfig = {
  ...defaultConfig,
  ...userConfig,
  duration: userConfig.duration ?? defaultConfig.duration
};
```

## 五、注意事项

1. **类型转换规则**：

   - 逻辑运算符会将操作数隐式转换为布尔值
   - 假值(falsy)包括：`false`, `0`, `''`, `null`, `undefined`, `NaN`

2. **运算优先级**：

   - `!` > `&&` > `||` > `??`
   - 不确定时使用括号明确优先级

3. **与比较运算符的区别**：

   ```javascript
   // 比较运算符返回布尔值
   console.log(1 === 1 && 2 === 3); // false

   // 逻辑运算符返回操作数值
   console.log(1 && 2); // 2
   ```

4. **现代 JavaScript 的替代方案**：
   - 默认值处理优先使用`??`而非`||`
   - 属性访问优先使用可选链`?.`而非`&&`链式判断
